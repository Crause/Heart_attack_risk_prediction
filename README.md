# Приложение "Предсказание рисков сердечного приступа"
Приложение предсказывает риск сердечного приступа (1 - высокий, 0 - низкий) по входным признакам при помощи предобученной модели на базе `DecisionTreeClassifier`.

Метрики модели, полученные на валидационной выборке:
- `accuracy`: 0.409
- `f1`: 0.521
- `precision`: 0.362
- `recall`: 0.925
- `roc-auc`: 0.539

Пример входных признаков представлен в файле `templates/input_example.csv`.

# Архитектура приложения
Приложение состоит из двух файлов:
- `app.py` - веб-сервер.
- `predictor.py` - класс работы с моделью.

Класс `Predictor()` при инициализации загружает предобученную модель.

Имеет три поля:
- `features` (pd.DataFrame()) - датафрейм с исходными входными признаками
- `features_proc` (pd.DataFrame()) - датафрейм входных признаков после предобработки
- `predictions` (pd.DataFrame()) - датафрейм с результатами предсказаний

Методы класса:
- `predict` (публичный) - запускает процессы предобработки признаков и предсказания. В процессе работы заполняет поля все три поля класса.
- `__proc` (приватный) - предобрабатывает исходный датафрейм в формат, используемый моделью для предсказаний.
- `__fill_missing` (приватный) - заполняет пустое значение признаковой строки на основании значений в другом признаке этой же строки.
- `__fill_missing_2d` (приватный)- заполняет пустое значение признаковой строки на основании значений в двух других признаках этой же строки.

# Запуск приложения
Веб-приложение запускается через файл `app.py`. Адрес по умолчанию `http://0.0.0.0:8000`.

На главной странице присутствуют два блока.
1. Предсказание по входным признакам. Первым делом необходимо файл с признаками. После чего необходимо нажать кнопку `Предсказать`. По завершению процесса предсказания будет предложен к сохранению файл с результатами. Формат результирующего файла `CSV`, разделитель - `запятая`, колонки - `id`, `prediction`.
2. Пример файла с входными признаками. При нажатии на кнопку `Получить` будет предложен к сохранению файл-пример для загрузки к предсказанию.

# Пример использования класса Predictor
Инициализация и заполнение:
```py
predictor = Predictor() # инициализируем модель
predictor.predict('input_features.csv') # предсказываем таргет и заполняем поля класса
```
Обращение к полям класса:
```py
predictor.features.to_csv('features.csv') # сохраняем в файл исходные признаки (файл аналогичен загружаемому - input_features.csv)
```
```py
predictor.features_proc.to_csv('features_proc.csv') # сохраняем в файл предобработанные признаки
```
```py
predictor.predictions.to_csv('predictions.csv') # сохраняем в файл предсказанные метки
```